library(phangorn)
library(ggplot2)
library(ggrepel)
library(cowplot)
x <- read.nexus.dist(file="~/Downloads/concatHKY.dist")
fit <- cmdscale(x, eig=T, k=2)
eigenvec <- cbind(rownames(fit$points), fit$points[,1:2])
species <- read.csv("~/Downloads/JTCoords.csv")
species$Species <- gsub(pattern = "\\.| " , "", species$Species)
species$Species <- substr(species$Species,1,4)
aruncol <- scale_color_manual(breaks = c("Ahyb", "Aapp", "Agig", "Atec", "Unkn"),
values = c("#440154FF", "#3B528BFF", "#21908CFF", "#5DC863FF", "#FDE725FF"),
labels = c("Hybrid", "A. appalachiana", "A. gigantea", "A. tecta", "Unknown"))
mdsdata <- merge(eigenvec, species, by.x="V1", by.y="Sample")
mdsdata$V2 <- as.numeric(as.character(mdsdata$V2))
mdsdata$V3 <- as.numeric(as.character(mdsdata$V3))
mdsdata$Species <- as.factor(mdsdata$Species)
ggplot(data = mdsdata, aes(x = V3, y = V2, color=Species)) +
#labs(title="Nuclear and Plastid SNP MDS (SplitsTree)", x="Dimension 1", y="Dimension 2") +
labs(title="Nuclear SNP MDS (SplitsTree)", x="Dimension 1", y="Dimension 2") +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()) +
geom_point(size = 3) +
geom_text_repel(aes(label = V1)) +
aruncol
ggplot(data = mdsdata, aes(x = -V3, y = V2, color=Species)) +
#labs(title="Nuclear and Plastid SNP MDS (SplitsTree)", x="Dimension 1", y="Dimension 2") +
labs(title="Nuclear SNP MDS (SplitsTree)", x="Dimension 1", y="Dimension 2") +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()) +
geom_point(size = 3) +
geom_text_repel(aes(label = V1)) +
aruncol
x <- read.nexus.dist(file="~/Downloads/LFY.dist")
library(phangorn)
library(ggplot2)
library(ggrepel)
library(cowplot)
x <- read.nexus.dist(file="~/Downloads/LFY.dist")
fit <- cmdscale(x, eig=T, k=2)
eigenvec <- cbind(rownames(fit$points), fit$points[,1:2])
species <- read.csv("JTCoords.csv")
getwd()
species <- read.csv("phylo/JTCoords.csv")
species$Species <- gsub(pattern = "\\.| " , "", species$Species)
species$Species <- substr(species$Species,1,4)
aruncol <- scale_color_manual(breaks = c("Ahyb", "Aapp", "Agig", "Atec", "Unkn"),
values = c("#440154FF", "#3B528BFF", "#21908CFF", "#5DC863FF", "#FDE725FF"),
labels = c("Hybrid", "A. appalachiana", "A. gigantea", "A. tecta", "Unknown"))
mdsdata <- merge(eigenvec, species, by.x="V1", by.y="Sample")
mdsdata$V2 <- as.numeric(as.character(mdsdata$V2))
mdsdata$V3 <- as.numeric(as.character(mdsdata$V3))
mdsdata$Species <- as.factor(mdsdata$Species)
ggplot(data = mdsdata, aes(x = V3, y = V2, color=Species)) +
#labs(title="Nuclear and Plastid SNP MDS (SplitsTree)", x="Dimension 1", y="Dimension 2") +
labs(title="Nuclear SNP MDS (SplitsTree)", x="Dimension 1", y="Dimension 2") +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()) +
geom_point(size = 3) +
geom_text_repel(aes(label = V1)) +
aruncol
library(phangorn)
splits <- read.nexus.networx(file="~/Downloads/LFY.nex")
splits$tip.label
splits <- read.nexus.networx(file="~/Downloads/LFY.nex")
splits$tip.label
label_ref <- read.csv("phylo/JTCoords.csv", header=T, stringsAsFactor = F)
label_ref$Species <- as.factor(gsub(pattern = "\\.| ", "", label_ref$Species))
species <- setNames(label_ref$Species, label_ref$Sample)[splits$tip.label]
species
splits2 <- splits
splits2$tip.label <- as.character(species)
colmap <- setNames(c("#440154FF", "#3B528BFF", "#21908CFF", "#5DC863FF", "#FDE725FF"),
c("Ahybrid", "Aappalachiana", "Agigantea", "Atecta", "Unknown")
)
species2 <- colmap[as.character(species)]
par(mar = c(0,0,2,0))
plot(splits, "2D",
tip.col = species2,
edge.width = 1.5,
cex = 1,
font = 3)
?plot
plot(splits, "2D",
tip.col = species2,
edge.width = 1.5,
cex = 1,
font = 3,
rotate.tree=180)
title(main = "Nuclear and Plastid SNP SplitsTree")
legend("topleft",legend=c("Hybrid", "A. appalachiana", "A. gigantea", "A. tecta", "Unknown"),col=colmap, pch=16, bty="n")
x <- read.nexus.dist(file="~/Downloads/plast.dist")
fit <- cmdscale(x, eig=T, k=2)
eigenvec <- cbind(rownames(fit$points), fit$points[,1:2])
mdsdata <- merge(eigenvec, species, by.x="V1", by.y="Sample")
mdsdata$V2 <- as.numeric(as.character(mdsdata$V2))
mdsdata$V3 <- as.numeric(as.character(mdsdata$V3))
mdsdata$Species <- as.factor(mdsdata$Species)
x <- read.nexus.dist(file="~/Downloads/plast.dist")
fit <- cmdscale(x, eig=T, k=2)
eigenvec <- cbind(rownames(fit$points), fit$points[,1:2])
species <- read.csv("phylo/JTCoords.csv")
species$Species <- gsub(pattern = "\\.| " , "", species$Species)
species$Species <- substr(species$Species,1,4)
aruncol <- scale_color_manual(breaks = c("Ahyb", "Aapp", "Agig", "Atec", "Unkn"),
values = c("#440154FF", "#3B528BFF", "#21908CFF", "#5DC863FF", "#FDE725FF"),
labels = c("Hybrid", "A. appalachiana", "A. gigantea", "A. tecta", "Unknown"))
mdsdata <- merge(eigenvec, species, by.x="V1", by.y="Sample")
mdsdata$V2 <- as.numeric(as.character(mdsdata$V2))
mdsdata$V3 <- as.numeric(as.character(mdsdata$V3))
mdsdata$Species <- as.factor(mdsdata$Species)
ggplot(data = mdsdata, aes(x = V3, y = V2, color=Species)) +
#labs(title="Nuclear and Plastid SNP MDS (SplitsTree)", x="Dimension 1", y="Dimension 2") +
labs(title="Nuclear SNP MDS (SplitsTree)", x="Dimension 1", y="Dimension 2") +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()) +
geom_point(size = 3) +
geom_text_repel(aes(label = V1)) +
aruncol
ggplot(data = mdsdata, aes(x = V3, y = V2, color=Species)) +
#labs(title="Nuclear and Plastid SNP MDS (SplitsTree)", x="Dimension 1", y="Dimension 2") +
labs(title="Plastid SNP MDS (SplitsTree)", x="Dimension 1", y="Dimension 2") +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()) +
geom_point(size = 3) +
geom_text_repel(aes(label = V1)) +
aruncol
x
row.names(x)
names(x)
attrib(x)
attributes(x)
x$labels
x$Labels
x[1]
x[]
x[,"Labels"]
x["Labels"]
x[81]
x[[81]]
attr(x)
attr(x, "Labels")
attr(x, "Labels")[81]
attr(x, "Labels")[81] <- "Tec7"
attr(x, "Labels")[81]
attr(x, "Labels")[5]
attr(x, "Labels")[5] <- "Gig9"
fit <- cmdscale(x, eig=T, k=2)
eigenvec <- cbind(rownames(fit$points), fit$points[,1:2])
species <- read.csv("phylo/JTCoords.csv")
species$Species <- gsub(pattern = "\\.| " , "", species$Species)
species$Species <- substr(species$Species,1,4)
aruncol <- scale_color_manual(breaks = c("Ahyb", "Aapp", "Agig", "Atec", "Unkn"),
values = c("#440154FF", "#3B528BFF", "#21908CFF", "#5DC863FF", "#FDE725FF"),
labels = c("Hybrid", "A. appalachiana", "A. gigantea", "A. tecta", "Unknown"))
mdsdata <- merge(eigenvec, species, by.x="V1", by.y="Sample")
mdsdata$V2 <- as.numeric(as.character(mdsdata$V2))
mdsdata$V3 <- as.numeric(as.character(mdsdata$V3))
mdsdata$Species <- as.factor(mdsdata$Species)
ggplot(data = mdsdata, aes(x = V3, y = V2, color=Species)) +
#labs(title="Nuclear and Plastid SNP MDS (SplitsTree)", x="Dimension 1", y="Dimension 2") +
labs(title="Plastid SNP MDS (SplitsTree)", x="Dimension 1", y="Dimension 2") +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()) +
geom_point(size = 3) +
geom_text_repel(aes(label = V1)) +
aruncol
mdsdata
species
library(phangorn)
library(ggplot2)
library(ggrepel)
library(cowplot)
